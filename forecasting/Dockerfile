
## NOTE: This Dockerfile will be using the R build and layer on with our packages
## necessary for Health Financing Forecasting and the general public fun stuffs

FROM reg.ihme.uw.edu/health_fin/r_base:latest
MAINTAINER Nafis Sadat, sadatnfs@uw.edu

## Modeling and paralleli`ing packages (basics and Xtra)
RUN ( Xvfb :0 -screen 0 1024x768x16 & ) && export DISPLAY=:0.0 && \
    R -e "require(devtools); install_github(c('yihui/servr', 'hafen/rmote', 'davharris/mistnet')); pacman::p_load(cairoDevice, gWidgetsRGtk2, rpart, BiplotGUI, rpanel, rattle, ggRandomForests, RGtk2Extras, OneR, neuralnet, validann, dae, asremlPlus, vcrpart, REEMtree, dismo, RcppDL, rnn, model4you, LTRCtrees, grplasso, grpreg, manipulateWidget)"
RUN R -e "pacman::p_load(P2C2M, penalized, rstan, rstanarm, githubinstall, rstansim, forecast, forecTheta, TSA, ecp, brms, prophet, copula, VineCopula, hnp, tsDyn, dynlm, CADFtest, pco,  MCMCpack, MCMCglmm, glmmBUGS, TreeBUGS, dlm, sandwich, texreg, latex2exp,  CORElearn, btergm, egoTERGM, EpiModel, fergm, RDS, statnet, bdynsys, BANOVA, twitteR, dismo, FCNN4R, earth, BigRR, bmrm, pder, pdR, wahc)" && \
    R -e "pacman::p_load(bit64, SparseM, nloptr, wCorr, expp, rpanel, quantreg, gam, gamm4, gbm, lme4, lmmpar, lmvar, MarkowitzR, matrixpls, spam, numDeriv, modelr, nlme, matrixcalc, pbdSLAP, frontier, sfa, semsfa, msm, p3state.msm, spfrontier, ssfa, glmnet, binom, survey, Benchmarking, microbenchmark, brglm, mlogit, mnlogit, aod, AER, sampleSelection, kerasR, autoencoder, glmpath, biglasso, FactoMineR, amap)"
RUN R -e "pacman::p_load(SOAR, doMC, panelAR, panelvar, cluster, parallel, doParallel, future, survival, broom, boot, mvtnorm, MASS, foreign, arm, KernSmooth, DirichletReg, qrLMM, qrNLMM, pscl, nonnest2, LinRegInteractive, ordinal, crch, REndo, rdd, rddapp, rddtools, rdrobust, rdlocrand, rdpower, mlVAR, RJSONIO, minpack.lm); install.packages('xgboost', repos=c('http://dmlc.ml/drat/', getOption('repos')), dependencies=T, type='source')"  && \
    R -e "pacman::p_load(party, Rfast, e1071, dse, sspir, KFAS, knn, class, mgm, fitdistrplus, actuar, ppclust, tikzDevice, spatial, mgcv, GAMBoost, gamboostLSS,  grplasso, GMMBoost, lmm,  argparse, fracdiff, tseries, mlbench, CLME, mvnfast, ivprobit, LARB, ivpack, extraTrees, lfe, ivpanel, ivbma, ivlewbel, iml, bigtime, gdpc, pcdpca, TSA, TSCS, tsdisagg, tsgui, tswge, FSA, fishMod, gllvm, radix)" 
RUN R -e "pacman::p_load(GJRM, tseries, tsDyn, covafillr, tscount, sem, GenSA, robustrank, staTools, magicaxis, sparsereg, SparseFactorAnalysis, SimMultiCorrData, sampleSelection, BSquare, EurosarcBayes, fakeR, astsa, nlWaldTest, car, truncreg,  SemiParSampleSel, censReg, frm, MTS, BigVAR, svars, mAr, sparsevar, fastcluster, fastclime, gcbd, grofit, MortalityLaws, fmsb, sm, mvabund, MatrixCorrelation)" && \
    R -e "pacman::p_load(OpenMx, simsalapar, parallelMap, IndependenceTests, Chaos01, fNonlinear, nonlinearTseries, ConjointChecks, betareg, Bergm, blkergm, CCMnet, dnr, ergm.count, ergm.ego, ergm.graphlets, ergm.rank, ergm.userterms, gwdegree, hergm, latentnet, lvm4net, statnetWeb, tergm, VBLPCM, xergm.common, magrittr, nnfor, kde1d, kdecopula, rrr, mvord, psych, spatstat, spatstat.utils)"
RUN R -e "pacman::p_load(ompr, ROI, redist, plsVarSel, pls, PCIT, lavaan, np, ExtremeBounds, Zelig, elasticnet, fields, BEST, bestglm, RandomFields, RandomFieldsUtils, CompRandFld, nnet, SGL, BMS, BMA, multcomp, vcd, caret, caretEnsemble, keras, compositions, systemfit, lmtest, stats, timeDate, zoo, loo, KFAS, httr, MXM, hdi, chemometrics, RSpectra, speedglm, spls, sva, fftwtools, deldir, goftest, NormalBetaPrime, mixlm)" && \
    R -e "pacman::p_load(sparseHessianFD, sparseMVN, trustOptim, bayesGDS, kernlab, tgp, GPfit, FastGP, kergp, gptk, mlegp, GPFDA, GauPro, iprior, pbapply, randomForest, GPareto, bkmr, laGP, vbmp, plgp, spBayes, SwarmSVM, classyfire, strucchange, urca, merTools, rlist, Bmix, bclust, mcclust, mixAK, BayesianTools, acebayes, RSNNS, deepnet, rnn, darch, rvinecopulib, FNN, GpGp, sfadv, NeuralNetTools, unmarked)"
RUN R -e "pacman::p_load(C50, gtable, hglm, MuMIn, metafor, Amelia, mice, ROCR, klaR, RWeka, ipred, snow, mboost, arules, VARsignR, autovarCore, VAR.etp, VARtests, VARsignR, hashmap, pbmcapply, pbapply, depmixS4, TTR, NHMSAR, HMM, HiddenMarkov, markovchain, meboot, arfima, phtt, rvest, Rcrawler, RCurl, rjson, blsAPI, rnoaa, rtimes, spanel, CoImp, CoClust, Copula.Markov, CopulaRegression, pracma)" && \
    R -e "pacman::p_load(tictoc, geoSpectral, rms, gamlss, gamlss.data, etm, svgPanZoom, gridSVG, svglite, hybridEnsemble, flexsurv, flexrsurv, Biograph, spTimer, spacetime, bsts, proxy, tigre, vars, forecastSNSTS, mlVAR, treeClust, clustvarsel, G1DBN, ebdbNet, bnstruct, bnlearn, walker, dcmr, limSolve, hdm, gradDescent, BART, dbarts, beepr, ivtools, CopulaREMADA, gamCopula, gcmr, GMCM, pencopula)"
RUN R -e "pacman::p_load(adaptsmoFMRI, aoristic, dbmss, Digiroo2, dixon, DSpat, ecespa, GriegSmith, idar, latticeDensity, overlapptest, ppmlasso, rase, sclero, selectspm, SGCS, siar, siplab, sparr, SpatEntropy, spatialsegregation, SpatialVx, spatstat.local, spatstat.data, AMORE)" && \
    R -e "pacman::p_load(teigen, mclust, clusterSim, gdistance, apcluster, RUnit, clustMixType, tclust, trimcluster, skmeans, kml, bgmm, EMCluster, funHDDC, funFEM, FisherEM, HDclassif, mixtools, pmclust, rebmix, bridgesampling, bridgedist, bridge, move, PReMiuM, CEC, depmix, flexCWM, mixreg, lcmm, MARSS, MAR1, mar1s, robusarima, tsPI, freqdom, freqdom.fda, networkTomography, bartMachine, sbgcop, SimCop, SimCorMultRes, SimCorrMix, subrank)"
RUN R -e "pacman::p_load(ads, alphahull, BAT, Biolinv, colordistance, ConR, dpcR, ecospat, ETAS, gridsample, hht, highriskzone, IDSpatialStats, intamapInteractive, lgcp, lqr, MetaLandSim, mopa, NLMR, osmplotr, palm, qlcVisualize, radiomics, replicatedpp2w, RImageJROI, rLiDAR)" && \
    R -e "pacman::p_load(rust, archdata, smacpod, smicd, spatialEco, spatialkernel, spatsurv, sppmix, SPUTNIK, stpp, surveillance, swfscMisc, tabularaster, trip, tweet2r, visualFields, windfarmGA, qle, mlxR, deSolve, rmr, enc, rematch2, styler, vbmp)"

## Graphing packages
RUN R -e "pacman::p_load(colorspace, manipulate, pheatmap, rggobi, ggcorrplot, colorRamps, clusterfly, productplots, tkrplot, scatterplot3d, munsell, dichromat, mime, plotly, extrafont, showtext, animation, rlecuyer, nws, tis, tframe, GGally, geofacet, echarts4r, plumber, officeR)" && \
    R -e "pacman::p_load(ggvis, htmlwidgets, networkD3, d3r, ggfortify, ggiraph, rgl, ggrepel, ggalt, ggtree, lattice, corrplot, graphics, hrbrthemes, xaringan, corrgram, mapsapi, tidycensus, rga, metricsgraphics, taucharts, visreg, ggformula)"
RUN R -e "pacman::p_load(lubridate, tmaptools, maptree, tmap, colourpicker, gtools, shinystan, shinydashboard, shinyjs, shinythemes, misc3d, colorspace, RColorBrewer, imager, diagram, DiagrammeR, networkD3, timevis, waffle, ggseas, TSstudio, ZRA, fanplot, gmodels, flexdashboard, ExPanDaR)" 
RUN R -e "pacman::p_load(Cairo, RBGL, RLumShiny, rhandsontable, gridExtra, ggthemes, ggmosaic, ggpubr, ggplot2movies, RapidPolygonLookup, maptools, classInt, scales, labeling, ggmap, profvis, d3heatmap, dygraphs, extrafont, rje, viridis, viridisLite, txtplot, bayesplot, maps, janitor, highcharter, listviewer, tabplotd3, gridSVG, visNetwork, gRbase )"
RUN R -e "pacman::p_load(GSIF, sn, rasterVis, plotKML, intervals, spcosa, gdalUtils, uuid, gpclib, shapefiles, mapproj, geoR, rgeos, bindr, httpuv, sourcetools, htmlwidgets, plot3D, miniUI, crosstalk, glue, plogr, DT, googleVis, threejs, loo, ggExtra, ggdendro, treemapify, adegraphics, rglwidget, metricsgraphics, gdtools)"

## Some MOAR packages
RUN R -e "pacman::p_load(AR1seg, bssm, smooth, vegan, mobsim, SSsimple, bsamGP, GPM, GPLTR, GPrank, GPGame, hetGP, IGP, MLZ, laGP,  nsgp, BCEA, opera, ensembleBMA, ForecastCombinations, marked, glmer2stan, spaMM, geostatsp, SuperGauss, PrevMap, inlabru, spectralGP, partialAR, partialCI, tsPI, partykit, MetaLandSim, futile.options, futile.paradigm, parallelMCMCcombine)" && \
    R -e "pacman::p_load(fdrtool, rex, NMF, neldermead, optimx, mxnet, optimr, bbmle, rstpm2, JuniperKernel, fastGHQuad, nls2, nlmrt, faraway, VGAM, lmtest, robust, spatialCovariance, urca, SpatioTemporal, spate, doBy, R2jags, rjags, jagsUI, scoringRules, ensembleMOS, verification, SpecsVerification, crch, polyCub, lwgeom, nngeo, statesRcontiguous, tilegramsR)"
RUN R -e "pacman::p_load(R2BayesX, bayesm, glmmTMB, pomp, tmbstan, abn, LearnBayes, beast, AdMit, abc, bayesGARCH, BayesSummaryStatLM, BayesTree, bayesQR, BAYSTAR, relaimpo, deBInfer, factorQR, FME, mcmc, ggmcmc, nimble, stochvol, zoib, bayesmix, BayesX, Boom, erer, ck37r, tmle, cvAUC, RANN, wbstats, wppExplorer, bea.R, qtl, qtlnet, imagine, signal, datasets, WGCNA, ProFit, cctools)"
RUN R -e "pacman::p_load(R2admb, PBSadmb, ipdw, locfit,  FitAR, FitARMA, itsmr, gsarima, perARMA, SpaDES.core, spectral, descomponer, fourierin, GeomComb, ForecastComb, forecastHybrid, GeomComb, rugarch, bvarsv, TSPred, KFKSDS, CausalImpact, CARBayes, CARBayesST, ltsa, timsac, tsbugs, AEDForecasting, brew, Rook, windfarmGA, DistributionUtils, magick, kedd, coga, ziphsmm, Rivivc, neural, grnn);" && \
    R -e "pacman::p_load(FRK, spdep, sphet, splm, spatialprobit, bayesmeta, bamlss, BVS, bbemkr, BLR, BoomSpikeSlab, eigenmodel, NetworkChange, spikeslab, spikeSlabGAM, SiMRiv, circular, adehabitatLT, diffusr, brea, gamlss.spatial, LatticeKrig, gstat, KernelKnn, LogicReg, soil.spec, BayesNetBP, googlePublicData, rkafka, OpenImageR, EBImage, convoSPAT, spatialfil, simcausal, appnn, deepnet)"
RUN R -e "pacman::p_load(bcmaps, brazilmaps, btb, cartogram, cartography, cdcfluview, concaveman, cyclestreets, echor, eixport, EmissV, eurostat, FedData, geogrid, geojsonio, GWSDAT, hydrolinks, jpmesh, jpndistrict, kokudosuuchi, LAGOSNE, landsepi, linemap,link2GI, lwgeom, mapedit, mapsapi, mapview, MODIS, NipponMap, GeneralizedHyperbolic, SkewHyperbolic, sna, ProbForecastGOP, sweep, flowfield, bit )" && \
    R -e "pacman::p_load(NLMR, openSTARS, Orcs, parlitools, quickmapr, RCzechia, reproducible, rgeopat2, rmapshaper, rmapzen, rnaturalearth, rpostgisLT, RQGIS, sabre, sfdct, smoothr, spatialEco, stplanr, tidycensus, tidyRSS, tigris, uavRmp, vein, velox, wunderscraper,  adklakedata, cancensus, crawl, RcppAnnoy, VarianceGamma, intergraph, influenceR, hts, Rssa, aTSA, PortfolioEffectHFT, midasr, units)"
RUN R -e "pacman::p_load(googlePolylines, GSODR, ipumsr, lutz, MODIStsp, mudata2, NetLogoR, opensensmapr, rcartocolor, spbabel, spData, spdep, swmmr, tabularaster, USAboundaries, DamiaNN, monmlp, brnn, GMDH, GMDH2, qgraph, softmaxreg, softmaxreg, ndtv, RSiena, RTextTools, tnam, crs, rminer, FCNN4R, BNN, networkDynamic, snowFT, tergm, QUIC, mafx, SptialVx, ForecastFramework, anomalize)"

## GitHub packages
RUN R -e 'library(pacman); pacman::p_load_gh("trinker/qdapDictionaries", "trinker/qdapRegex", "trinker/qdapTools","trinker/qdap", "r-spatial/stars", "kieranrcampbell/pseudogp", "rstudio/r2d3", "Microsoft/irmetrics-r", "nmmarquez/ar.matrix")' && \
    R -e "library(devtools); install_github('colemonnahan/adnuts', ref='master'); install_github('poissonconsulting/mbr'); install_github('goldingn/gpe'); install_github('RebeccaStubbs/MapSuite');install_github('statguy/SpaceTimeModels'); install_github('jennybc/googlesheets'); install_github('alexioannides/pipeliner'); devtools::install_github('ecpolley/SuperLearner', force=T); install_github('briandconnelly/growthcurve'); install_github('b-steve/sscr')"
RUN R -e "library(devtools); install_github('hadley/multidplyr'); install_github('hafen/rbokeh'); install_github('hadley/lineprof', force = T); install_github('rmcelreath/rethinking'); install_github('enanomapper/RRegrs', subdir='RRegrs'); install_github('james-thorson/VAST'); install_github('timelyportfolio/rcdimple'); install_github('growthmodels', 'drodriguezperez'); install_github('ianjonsen/ssmTMB'); install_github('anqif/CVXR'); install_github('terrytangyuan/rflow')"
RUN R -e 'library(devtools); install_github("emanuelhuber/GauProMod", force = T); install.packages("glmmADMB", repos=c("http://glmmadmb.r-forge.r-project.org/repos", getOption("repos")),  type="source");  install_github("dgrtwo/gganimate"); install_github("trnnick/TStools"); install_github("andrewzm/MVST",build_vignettes=F,dependencies=T); install_github("Microsoft/LightGBM"); install_github("Microsoft/LightGBM", subdir = "R-package"); install_github("sofpj/mumm")' && \
    R -e "library(devtools); install_github('greta-dev/greta', force = T, ref = 'dev'); install_github('goldingn/gpflowr'); install_github('greta-dev/greta.gp'); install_github('kaskr/TMB_contrib_R/TMBhelper'); install_github('kaskr/TMB_contrib_R/TMBphase'); install_github('andrewzm/hmc', dependencies=T); install_github('andrewzm/medalplot',build_vignettes=F); install_github('r4ss/r4ss'); install.packages('countreg', repos='http://R-Forge.R-project.org')"
RUN R -e 'library(devtools); install_github("nwfsc-assess/geostatistical_delta-GLMM"); install_github("mlr-org/mlr"); install_github("mlr-org/mlrCPO"); install_github("mlr-org/mlrMBO"); install_github("mlr-org/shinyMlr/package") ; install_github("jjallaire/TBB"); install_github("andrewzm/linalg", dependencies=T); install_github("RBigData/pbdMPI"); install_github("seananderson/glmmfields")'
RUN R -e "library(devtools); install_github('SEEG-Oxford/seegSDM'); install_github('SEEG-Oxford/seegMBG'); install_github('SEEG-Oxford/movement'); install_github('rstudio/leaflet', force=T); install_github('bhaskarvk/leaflet.extras'); install_github('andrewzm/atminv',build_vignettes=F,dependencies=T); install_github('mingjerli/rWEO'); install_github('seananderson/ggsidekick'); install_github('maddin79/darch'); install_github('ianjonsen/bsam') " && \
    R -e "library(devtools); install_github('quang-huynh/MLZ'); install_github('poissonconsulting/tmbr'); install_github('rCharts', 'ramnathv'); install_github('james-thorson/MIST'); install.packages('BIOMOD', repos='http://R-Forge.R-project.org'); remotes::install_github(c('ropensci/tabulizerjars', 'ropensci/tabulizer', 'ropensci/ropkgs', 'ropensci/tokenizers', 'ropensci/ckanr', 'ropensci/rdataretriever', 'ropensci/elastic', 'ropensci/etseed', 'ropensci/aRxiv', 'ropensci/assertr'))"
